<link rel="import" href="bower_components/bc-d3-polymer/bc-d3-polymer-bargraph.html">
<link rel="import" href="bower_components/bc-d3-polymer/bc-d3-polymer-singraph.html">
<link rel="import" href="bower_components/bc-d3-polymer/bc-d3-polymer-multi-singraph.html">

<polymer-element name="bc-d3-group" attributes="width height">
  <template>
    <style>
      :host div {
        padding: 0px;
        border: 0px;
        margin: 0px;
      }
    </style>
    <div style='margin-bottom: 20px;'>
    <!-- <bc-d3-brush
      height="28"
      data="{{data}}"
      domain="{{domain}}"
      width="{{width}}"
      debug="{{debug}}"></bc-d3-brush>
    </div> -->
    <div>
    <bc-d3-polymer-singraph
      height="{{height}}"
      data="{{data}}"
      domain="{{domain}}"
      width="{{width}}"
      showPoints="true"
      debug="{{debug}}"></bc-d3-polymer-singraph>
    </div>
    <div>
    <bc-d3-polymer-bargraph
      height="{{height}}"
      data="{{data}}"
      domain="{{domain}}"
      width="{{width}}"
      debug="{{debug}}"></bc-d3-polymer-bargraph>
    </div>
    <bc-d3-polymer-multi-singraph
      id="multi-sin"
      height="{{height}}"
      data="{{multiData}}"
      domain="{{domain}}"
      width="{{width}}"
      showPoints="true"
      debug="{{debug}}"></bc-d3-polymer-multi-singraph>
    </div>
    <!-- <div>
    <bc-d3-xValline
      height="28"
      data="{{data}}"
      domain="{{domain}}"
      width="{{width}}"
      debug="{{debug}}"></bc-d3-xValline>
    </div> -->
  </template>
  <script>
    Polymer('bc-d3-group', {
      created: function() {
        this.debug = false;
        var format = d3.time.format("%Y-%m-%d");
        this.data = [
          {xVal: format.parse("2014-02-01"), yVal: 10, label: "WSW"},
          {xVal: format.parse("2014-02-02"), yVal: 8, label: "SSW"},
          {xVal: format.parse("2014-02-03"), yVal: 6, label: "S"},
          {xVal: format.parse("2014-02-04"), yVal: 4.7, label: "SE"},
          {xVal: format.parse("2014-02-05"), yVal: 8, label: "E"},
          {xVal: format.parse("2014-02-06"), yVal: 6, label: "N"},
          {xVal: format.parse("2014-02-07"), yVal: 4, label: "N"},
          {xVal: format.parse("2014-02-08"), yVal: 8.5, label: "WSW"},
          {xVal: format.parse("2014-02-09"), yVal: 7, label: "WSW"},
          {xVal: format.parse("2014-02-10"), yVal: 1, label: "WSW"}
        ];
        this.multiData = [
          {
            data: [
              {xVal: format.parse("2014-02-01"), yVal: 10, label: "WSW"},
              {xVal: format.parse("2014-02-02"), yVal: 8, label: "SSW"},
              {xVal: format.parse("2014-02-03"), yVal: 6, label: "S"},
              {xVal: format.parse("2014-02-04"), yVal: 4.7, label: "SE"},
              {xVal: format.parse("2014-02-05"), yVal: 8, label: "E"},
              {xVal: format.parse("2014-02-06"), yVal: 6, label: "N"},
              {xVal: format.parse("2014-02-07"), yVal: 4, label: "N"},
              {xVal: format.parse("2014-02-08"), yVal: 8.5, label: "WSW"},
              {xVal: format.parse("2014-02-09"), yVal: 7, label: "WSW"},
              {xVal: format.parse("2014-02-10"), yVal: 1, label: "WSW"}
            ],
            className: "d1"
            // fillColor: "steelblue",
            // strokeColor: "white",
            // fillOpacity: "1"
          },
          {
            data: [
              {xVal: format.parse("2014-02-01"), yVal: 2, label: "WSW"},
              {xVal: format.parse("2014-02-02"), yVal: 7, label: "SSW"},
              {xVal: format.parse("2014-02-03"), yVal: 5, label: "S"},
              {xVal: format.parse("2014-02-04"), yVal: 2.1, label: "SE"},
              {xVal: format.parse("2014-02-05"), yVal: 12, label: "E"},
              {xVal: format.parse("2014-02-06"), yVal: 9, label: "N"},
              {xVal: format.parse("2014-02-07"), yVal: 4, label: "N"},
              {xVal: format.parse("2014-02-08"), yVal: 4, label: "WSW"},
              {xVal: format.parse("2014-02-09"), yVal: 3, label: "WSW"},
              {xVal: format.parse("2014-02-10"), yVal: 8, label: "WSW"}
            ],
            className: "d2"
            // fillColor: "#333",
            // strokeColor: "#999",
            // fillOpacity: ".5"
          }
        ];
        this.d1 = 0;
        this.d2 = this.data.length - 1;
        this.domain = [this.data[this.d1].xVal, this.data[this.d2].xVal];

        if(this.debug) {
          console.log('passing data:');
          console.log(this.data);
        }
      },
      dropWidth: function() {
        this.width = -50 + (this.width*1);
        this.height = -10 + (this.height*1);
      },
      raiseWidth: function() {
        this.width = 50 + (this.width*1);
        this.height = 10 + (this.height*1);
      },
      shrinkDomain: function() {
        if (this.d2 > 1) {this.d2--;}
        this.domain = [this.data[this.d1].xVal, this.data[this.d2].xVal];
        if(this.debug) {
          console.log("shrinking domain");
          console.log(this.domain);
        }
      },
      expandDomain: function() {
        if (this.d2 < this.data.length - 1) {this.d2++;}
        this.domain = [this.data[this.d1].xVal, this.data[this.d2].xVal];
        if(this.debug) {
          console.log("expanding domain");
          console.log(this.domain);
        }
      },
      randomizeData: function() {
        var max = 15;
        newData = [];
        for(i=0;i<this.data.length;i++) {
          var newD = this.data[i];
          var newVal = Math.floor((Math.random()*max));
          newD.yVal = newVal;
          newData.push(newD);
        }
        this.data = newData;

        newData = [];
        for(i=0;i<this.multiData.length;i++) {
          newData.push({
            data: [],
            className: this.multiData[i].className
          });
          // newData.push(this.multiData[i]);
          // newData[i].data = [];
          for(j=0;j<this.multiData[i].data.length;j++) {
            newData[i].data.push(this.multiData[i].data[j]);
            newData[i].data[j].yVal = Math.floor((Math.random()*max));
          }
        }
        this.multiData = newData;
      }
    });
  </script>
</polymer-element>
